{"version":3,"file":"CarDetailsView-1e662c2c.js","sources":["../src/components/PhotosPopup.vue","../src/components/CarComponentsInterval.vue","../src/components/CarDetails.vue","../src/views/CarDetailsView.vue"],"sourcesContent":["<template>\r\n    <div class=\"popup-container\" v-show=\"showPopup\">\r\n        <div class=\"popup\">\r\n            <h2>Photos of your car with registration number: {{ reg_number }}</h2>\r\n            <div class=\"photos\">\r\n                <img v-for=\"(photo, index) in photos\" :key=\"index\" :src=\"photo.url\" />\r\n            </div>\r\n            <button @click=\"closePopup\">Close</button>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import { storage } from \"../firebase\";\r\n    import { ref, listAll, getDownloadURL } from \"firebase/storage\";\r\n\r\n    export default {\r\n        name: 'PhotosPopup',\r\n        props: {\r\n            showPopup: {\r\n                type: Boolean,\r\n                default: false\r\n            },\r\n            reg_number: String\r\n        },\r\n        data() {\r\n            return {\r\n                photos: []\r\n            }\r\n        },\r\n        methods: {\r\n            closePopup() {\r\n                this.$emit(\"close-popup\");\r\n            }\r\n        },\r\n        async created() {\r\n            try {\r\n                const storageRef = ref(storage, `cars/${this.reg_number}`);\r\n                const images = await listAll(storageRef);\r\n                images.items.forEach(async (imageRef) => {\r\n                    const url = await getDownloadURL(imageRef);\r\n                    this.photos.push({ url });\r\n                });\r\n            } \r\n            catch (error) {\r\n                console.error(error);\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n.popup-container {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n.popup {\r\n  background-color: #fff;\r\n  padding: 20px;\r\n  border-radius: 5px;\r\n  box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.5);\r\n}\r\nh2 {\r\n  margin-top: 0;\r\n}\r\n.photos {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  justify-content: center;\r\n}\r\n.photos img {\r\n  width: 200px;\r\n  margin: 10px;\r\n  object-fit: cover;\r\n}\r\nbutton {\r\n    padding: 10px;\r\n    background-color: #007bff;\r\n    color: white;\r\n    border: none;\r\n    border-radius: 5px;\r\n    cursor: pointer;\r\n}\r\nbutton:hover {\r\n    background-color: #0069d9;\r\n}\r\n</style>","<template>\r\n    <div>\r\n        <div class=\"car-data\">\r\n            <span>{{ reg_number }}</span>\r\n            <!--\r\n            <span>{{ lastOilChange }}</span>\r\n            <div :class=\"{'color-box': true, 'red': oilChangeOverdue, 'green': !oilChangeOverdue}\">\r\n                <span>{{ oilChangeOverdue ? 'Overdue' : 'OK' }}</span>\r\n            </div>\r\n            -->\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name: 'CarComponentsInterval',\r\n        props: {\r\n            reg_number: String\r\n        },\r\n        computed: {\r\n            oilChangeOverdue() {\r\n                const oilChangeDueDate = new Date(\r\n                    this.lastOilChange.getTime() + this.oilChangeInterval * 86400000\r\n                );\r\n                const now = new Date();\r\n                return now > oilChangeDueDate;\r\n            },\r\n        },\r\n    };\r\n\r\n</script>\r\n\r\n<style>\r\n.car-data {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  margin-bottom: 10px;\r\n  font-size: 16px;\r\n}\r\n.color-box {\r\n  width: 80px;\r\n  height: 30px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  border-radius: 5px;\r\n  color: white;\r\n}\r\n.red {\r\n  background-color: #ff4444;\r\n}\r\n.green {\r\n  background-color: #00c851;\r\n}\r\n</style>","<template>\r\n    <div class=\"car-details\">\r\n        <div v-if=\"car\" class=\"car-info\">\r\n            <h2>{{ car.make }} {{ car.model }}</h2>\r\n            <p>Registration Number: {{ car.reg_number }}</p>\r\n        </div>\r\n\r\n        <CarComponentsInterval :reg_number=\"this.reg_number\" />\r\n\r\n        <div class=\"car-photos\">\r\n            <button v-if=\"hasPhotos\" @click=\"showPopup=true\">View Photos</button>\r\n            <photos-popup :show-popup=\"showPopup\" :reg_number=\"this.reg_number\" @close-popup=\"showPopup = false\" />\r\n\r\n            <button @click=\"openModal\">Add Photo</button>\r\n\r\n            <div class=\"modal\">\r\n                <div class=\"modal-dialog\">\r\n                    <div class=\"modal-content\">\r\n                        <div class=\"modal-header\">\r\n                            <h5 class=\"modal-title\">Take a photo</h5>\r\n                            <button type=\"button\" class=\"hideButton\">\r\n                            </button>\r\n                        </div>\r\n                        <div class=\"modal-body\">\r\n                            <video id=\"video\" width=\"100%\" height=\"auto\" autoplay></video>\r\n                        </div>\r\n                        <div class=\"modal-footer\">\r\n                            <button type=\"button\" class=\"btn btn-secondary\" @click=\"closeModal\">Close</button>\r\n                            <button type=\"button\" class=\"btn btn-primary\" @click=\"takePhoto\">Take Photo</button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>        \r\n        </div>\r\n    </div>\r\n\r\n</template>\r\n\r\n<script>\r\n    import { collection, getDocs } from \"firebase/firestore\"\r\n    import { onMounted } from \"vue\";\r\n    import { db, storage } from \"../firebase\";\r\n    import { ref, listAll, uploadBytes } from \"firebase/storage\";\r\n\r\n    import PhotosPopup from \"./PhotosPopup.vue\";\r\n    import CarComponentsInterval from \"./CarComponentsInterval.vue\";\r\n\r\n    export default {\r\n        name: 'CarDetails',\r\n        props: {\r\n            reg_number: String\r\n        },\r\n        components: {\r\n            PhotosPopup,\r\n            CarComponentsInterval\r\n        },\r\n        data() {\r\n            return {\r\n                car: null,\r\n                hasPhotos: false,\r\n                showPopup: false,\r\n                photos: []\r\n            }\r\n        },\r\n        created() {\r\n            const unsubscribe = onMounted(async () => {\r\n                const querySnapshot = await getDocs(collection(db, \"cars\"));\r\n                querySnapshot.forEach((doc) => {\r\n                    const carData = doc.data();\r\n                    if (carData.reg_number === this.reg_number) {\r\n                        this.car = carData;\r\n                    }\r\n                });\r\n            })\r\n\r\n            const unsubscribePhotos = onMounted(async () => {\r\n                const photoRef = ref(storage, `cars/${this.reg_number}`);\r\n                const photoList = await listAll(photoRef);\r\n                if (photoList.items.length > 0) {\r\n                    this.hasPhotos = true;\r\n            }\r\n            })\r\n        },\r\n        methods: {\r\n            openModal() {\r\n                const modal = document.querySelector(\".modal\");\r\n                modal.style.display = \"block\";\r\n\r\n                this.video = document.getElementById(\"video\");\r\n                navigator.mediaDevices\r\n                    .getUserMedia({ video: true })\r\n                    .then((stream) => {\r\n                        this.mediaStream = stream;\r\n                        this.video.srcObject = stream;\r\n                    })\r\n                    .catch((error) => {\r\n                        console.log(error);\r\n                    });\r\n            },\r\n            takePhoto() {\r\n                const canvas = document.createElement(\"canvas\");\r\n                canvas.width = this.video.videoWidth;\r\n                canvas.height = this.video.videoHeight;\r\n                canvas.getContext(\"2d\").drawImage(this.video, 0, 0);\r\n                canvas.toBlob(async (blob) => {\r\n                    const photoRef = ref(storage, `cars/${this.reg_number}/${Date.now()}.png`);\r\n                    await uploadBytes(photoRef, blob);\r\n                    this.closeModal();\r\n                }, \"image/png\", 1);\r\n            },\r\n            closeModal() {\r\n                const modal = document.querySelector(\".modal\");\r\n                modal.style.display = \"none\";\r\n            },\r\n            }\r\n        }\r\n</script>\r\n\r\n<style scoped>\r\n.car-photos {\r\n    position: fixed;\r\n    bottom: 0px;\r\n    width: 100%;\r\n    padding: 50px;\r\n    background-color: #f5f5f5;\r\n}\r\n.car-details {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    margin-top: 50px;\r\n  }\r\n  .car-info {\r\n    text-align: center;\r\n  }\r\n  .car-photos {\r\n    margin-top: 20px;\r\n  }\r\n  .car-photos button {\r\n    margin-right: 20px;\r\n    margin-left: 20px;\r\n}\r\n  button {\r\n    padding: 10px;\r\n    background-color: #007bff;\r\n    color: white;\r\n    border: none;\r\n    border-radius: 5px;\r\n    cursor: pointer;\r\n  }\r\n  .hideButton {\r\n    background-color: transparent;\r\n    border: none;\r\n    color: white;\r\n    cursor: pointer;\r\n  }\r\n  .hideButton:hover {\r\n    background-color: transparent;\r\n    border: none;\r\n    color: white;\r\n    cursor: pointer;\r\n  }\r\n  button:hover {\r\n    background-color: #0069d9;\r\n  }\r\n</style>","<template>\r\n    <TopBar />\r\n    <CarDetails :reg_number=\"this.$route.params.reg_number\"/>\r\n</template>\r\n\r\n<script>\r\n    import TopBar from '@/components/TopBar.vue'\r\n    import CarDetails from '../components/CarDetails.vue';\r\n\r\n    export default {\r\n        name: 'CarDetailsView',\r\n        components: {\r\n            TopBar,\r\n            CarDetails\r\n        }\r\n    }\r\n</script>\r\n\r\n<style>\r\n</style>"],"names":["_sfc_main","storageRef","ref","storage","listAll","imageRef","url","getDownloadURL","error","_hoisted_1","_hoisted_2","_hoisted_3","_withDirectives","_openBlock","_createElementBlock","_createElementVNode","_toDisplayString","$props","_Fragment","_renderList","$data","photo","index","$options","args","oilChangeDueDate","PhotosPopup","CarComponentsInterval","onMounted","getDocs","collection","db","doc","carData","photoRef","modal","stream","canvas","blob","uploadBytes","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_9","_createVNode","_component_CarComponentsInterval","_component_photos_popup","_hoisted_7","TopBar","CarDetails","_component_TopBar","_component_CarDetails"],"mappings":"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"}