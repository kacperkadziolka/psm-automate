{"version":3,"file":"CarDetailsView-3f56a94d.js","sources":["../src/components/PhotosPopup.vue","../src/components/CarComponentsInterval.vue","../src/components/CarDetails.vue","../src/views/CarDetailsView.vue"],"sourcesContent":["<template>\n    <div class=\"popup-container\" v-show=\"showPopup\">\n        <div class=\"popup\">\n            <h2>Photos of your car with registration number: {{ reg_number }}</h2>\n            <div class=\"photos\">\n                <img v-for=\"(photo, index) in photos\" :key=\"index\" :src=\"photo.url\" />\n            </div>\n            <button @click=\"closePopup\">Close</button>\n        </div>\n    </div>\n</template>\n\n<script>\n    import { storage } from \"../firebase\";\n    import { ref, listAll, getDownloadURL } from \"firebase/storage\";\n\n    export default {\n        name: 'PhotosPopup',\n        props: {\n            showPopup: {\n                type: Boolean,\n                default: false\n            },\n            reg_number: String\n        },\n        data() {\n            return {\n                photos: []\n            }\n        },\n        methods: {\n            closePopup() {\n                this.$emit(\"close-popup\");\n            }\n        },\n        async created() {\n            try {\n                const storageRef = ref(storage, `cars/${this.reg_number}`);\n                const images = await listAll(storageRef);\n                images.items.forEach(async (imageRef) => {\n                    const url = await getDownloadURL(imageRef);\n                    this.photos.push({ url });\n                });\n            } \n            catch (error) {\n                console.error(error);\n            }\n        }\n    }\n</script>\n\n<style scoped>\n.popup-container {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.popup {\n  background-color: #fff;\n  padding: 20px;\n  border-radius: 5px;\n  box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.5);\n}\nh2 {\n  margin-top: 0;\n}\n.photos {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n}\n.photos img {\n  width: 200px;\n  margin: 10px;\n  object-fit: cover;\n}\nbutton {\n    padding: 10px;\n    background-color: #007bff;\n    color: white;\n    border: none;\n    border-radius: 5px;\n    cursor: pointer;\n}\nbutton:hover {\n    background-color: #0069d9;\n}\n</style>","<template>\n    <div>\n        <div class=\"car-data\">\n            <span>{{ reg_number }}</span>\n            <!--\n            <span>{{ lastOilChange }}</span>\n            <div :class=\"{'color-box': true, 'red': oilChangeOverdue, 'green': !oilChangeOverdue}\">\n                <span>{{ oilChangeOverdue ? 'Overdue' : 'OK' }}</span>\n            </div>\n            -->\n        </div>\n    </div>\n</template>\n\n<script>\n    export default {\n        name: 'CarComponentsInterval',\n        props: {\n            reg_number: String\n        },\n        computed: {\n            oilChangeOverdue() {\n                const oilChangeDueDate = new Date(\n                    this.lastOilChange.getTime() + this.oilChangeInterval * 86400000\n                );\n                const now = new Date();\n                return now > oilChangeDueDate;\n            },\n        },\n    };\n\n</script>\n\n<style>\n.car-data {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 10px;\n  font-size: 16px;\n}\n.color-box {\n  width: 80px;\n  height: 30px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 5px;\n  color: white;\n}\n.red {\n  background-color: #ff4444;\n}\n.green {\n  background-color: #00c851;\n}\n</style>","<template>\n    <div class=\"car-details\">\n        <div v-if=\"car\" class=\"car-info\">\n            <h2>{{ car.make }} {{ car.model }}</h2>\n            <p>Registration Number: {{ car.reg_number }}</p>\n        </div>\n\n        <CarComponentsInterval :reg_number=\"this.reg_number\" />\n\n        <div class=\"car-photos\">\n            <button v-if=\"hasPhotos\" @click=\"showPopup=true\">View Photos</button>\n            <photos-popup :show-popup=\"showPopup\" :reg_number=\"this.reg_number\" @close-popup=\"showPopup = false\" />\n\n            <button @click=\"openModal\">Add Photo</button>\n\n            <div class=\"modal\">\n                <div class=\"modal-dialog\">\n                    <div class=\"modal-content\">\n                        <div class=\"modal-header\">\n                            <h5 class=\"modal-title\">Take a photo</h5>\n                            <button type=\"button\" class=\"hideButton\">\n                            </button>\n                        </div>\n                        <div class=\"modal-body\">\n                            <video id=\"video\" width=\"100%\" height=\"auto\" autoplay></video>\n                        </div>\n                        <div class=\"modal-footer\">\n                            <button type=\"button\" class=\"btn btn-secondary\" @click=\"closeModal\">Close</button>\n                            <button type=\"button\" class=\"btn btn-primary\" @click=\"takePhoto\">Take Photo</button>\n                        </div>\n                    </div>\n                </div>\n            </div>        \n        </div>\n    </div>\n\n</template>\n\n<script>\n    import { collection, getDocs } from \"firebase/firestore\"\n    import { onMounted } from \"vue\";\n    import { db, storage } from \"../firebase\";\n    import { ref, listAll, uploadBytes } from \"firebase/storage\";\n\n    import PhotosPopup from \"./PhotosPopup.vue\";\n    import CarComponentsInterval from \"./CarComponentsInterval.vue\";\n\n    export default {\n        name: 'CarDetails',\n        props: {\n            reg_number: String\n        },\n        components: {\n            PhotosPopup,\n            CarComponentsInterval\n        },\n        data() {\n            return {\n                car: null,\n                hasPhotos: false,\n                showPopup: false,\n                photos: []\n            }\n        },\n        created() {\n            const unsubscribe = onMounted(async () => {\n                const querySnapshot = await getDocs(collection(db, \"cars\"));\n                querySnapshot.forEach((doc) => {\n                    const carData = doc.data();\n                    if (carData.reg_number === this.reg_number) {\n                        this.car = carData;\n                    }\n                });\n            })\n\n            const unsubscribePhotos = onMounted(async () => {\n                const photoRef = ref(storage, `cars/${this.reg_number}`);\n                const photoList = await listAll(photoRef);\n                if (photoList.items.length > 0) {\n                    this.hasPhotos = true;\n            }\n            })\n        },\n        methods: {\n            openModal() {\n                const modal = document.querySelector(\".modal\");\n                modal.style.display = \"block\";\n\n                this.video = document.getElementById(\"video\");\n                navigator.mediaDevices\n                    .getUserMedia({ video: true })\n                    .then((stream) => {\n                        this.mediaStream = stream;\n                        this.video.srcObject = stream;\n                    })\n                    .catch((error) => {\n                        console.log(error);\n                    });\n            },\n            takePhoto() {\n                const canvas = document.createElement(\"canvas\");\n                canvas.width = this.video.videoWidth;\n                canvas.height = this.video.videoHeight;\n                canvas.getContext(\"2d\").drawImage(this.video, 0, 0);\n                canvas.toBlob(async (blob) => {\n                    const photoRef = ref(storage, `cars/${this.reg_number}/${Date.now()}.png`);\n                    await uploadBytes(photoRef, blob);\n                    this.closeModal();\n                }, \"image/png\", 1);\n            },\n            closeModal() {\n                const modal = document.querySelector(\".modal\");\n                modal.style.display = \"none\";\n            },\n            }\n        }\n</script>\n\n<style scoped>\n.car-photos {\n    position: fixed;\n    bottom: 0px;\n    width: 100%;\n    padding: 50px;\n    background-color: #f5f5f5;\n}\n.car-details {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    margin-top: 50px;\n  }\n  .car-info {\n    text-align: center;\n  }\n  .car-photos {\n    margin-top: 20px;\n  }\n  .car-photos button {\n    margin-right: 20px;\n    margin-left: 20px;\n}\n  button {\n    padding: 10px;\n    background-color: #007bff;\n    color: white;\n    border: none;\n    border-radius: 5px;\n    cursor: pointer;\n  }\n  .hideButton {\n    background-color: transparent;\n    border: none;\n    color: white;\n    cursor: pointer;\n  }\n  .hideButton:hover {\n    background-color: transparent;\n    border: none;\n    color: white;\n    cursor: pointer;\n  }\n  button:hover {\n    background-color: #0069d9;\n  }\n</style>","<template>\n    <TopBar />\n    <CarDetails :reg_number=\"this.$route.params.reg_number\"/>\n</template>\n\n<script>\n    import TopBar from '@/components/TopBar.vue'\n    import CarDetails from '../components/CarDetails.vue';\n\n    export default {\n        name: 'CarDetailsView',\n        components: {\n            TopBar,\n            CarDetails\n        }\n    }\n</script>\n\n<style>\n</style>"],"names":["_sfc_main","storageRef","ref","storage","listAll","imageRef","url","getDownloadURL","error","_hoisted_1","_hoisted_2","_hoisted_3","_withDirectives","_openBlock","_createElementBlock","_createElementVNode","_toDisplayString","$props","_Fragment","_renderList","$data","photo","index","$options","args","oilChangeDueDate","PhotosPopup","CarComponentsInterval","onMounted","getDocs","collection","db","doc","carData","photoRef","modal","stream","canvas","blob","uploadBytes","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_9","_createVNode","_component_CarComponentsInterval","_component_photos_popup","_hoisted_7","TopBar","CarDetails","_component_TopBar","_component_CarDetails"],"mappings":"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"}